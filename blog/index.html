<!doctype html>
<html lang="da">
<head>
  <!-- Header/nav (fælles) -->
  <script src="/assets/include-header.js?v=6" defer></script>

  <meta charset="utf-8" />
  <title>Blog – guides, tjeklister og værktøjer | Seohub.dk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Seohub Blog: SEO-guides, tjeklister og praktiske råd. Filtrér efter emner, søg i indlæg og læs vores udvalgte highlights." />
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="canonical" href="https://www.seohub.dk/blog/">

  <!-- GA + cookie consent -->
  <script src="/assets/consent-analytics.js" defer></script>

  <!-- UI -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html, body { overflow-x: hidden; }
    .chip { border-radius: 9999px; padding:.375rem .625rem; border:1px solid #e5e7eb; background:#fff; }
    .chip-active { background:#eef2ff; border-color:#c7d2fe; color:#3730a3; font-weight:600; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-neutral-50 to-neutral-100 text-neutral-900">

  <!-- Hero -->
  <section class="py-10 md:py-14">
    <div class="max-w-6xl mx-auto px-4">
      <div class="rounded-2xl p-12 md:p-16 text-white shadow-lg"
           style="background:linear-gradient(135deg,#6366f1 0%,#3b82f6 50%,#06b6d4 100%)">
        <p class="text-xs uppercase tracking-wider text-blue-100/90 mb-2">Blog</p>
        <h1 class="text-4xl md:text-5xl font-extrabold mb-3 leading-tight">Guides, tjeklister & SEO-indsigt</h1>
        <p class="text-blue-100 text-lg md:text-xl max-w-3xl">
          Filtrér efter emner eller søg i vores artikler. Udvalgte highlights øverst.
        </p>
      </div>
    </div>
  </section>

  <main class="max-w-6xl mx-auto px-4 pb-16">
    <!-- Controls -->
    <section class="bg-white/70 backdrop-blur rounded-2xl shadow p-6 md:p-8 border border-neutral-100">
      <div class="grid md:grid-cols-12 gap-4 md:gap-6 items-start">
        <!-- Søg -->
        <div class="md:col-span-5">
          <label class="block text-sm font-medium mb-2">Søg</label>
          <div class="flex items-center gap-2">
            <input id="q" type="search" placeholder="Søg i titler, beskrivelser og tags…"
                   class="w-full rounded-2xl border px-4 py-3 focus:outline-none focus:ring focus:ring-indigo-200" />
            <button id="clearBtn" class="text-sm px-3 py-2 rounded-xl border bg-neutral-50 hover:bg-neutral-100 hidden">Ryd</button>
          </div>
          <p class="text-xs text-neutral-500 mt-2">Tip: Prøv “intern link”, “title”, “lokal seo”, “sitemap”.</p>
        </div>

        <!-- Tags -->
        <div class="md:col-span-7">
          <label class="block text-sm font-medium mb-2">Emner</label>
          <div id="tagChips" class="flex flex-wrap gap-2"></div>
        </div>
      </div>
      <p id="diag" class="mt-3 text-xs text-neutral-400 hidden"></p>
    </section>

    <!-- Featured -->
    <section id="featuredWrap" class="mt-8 hidden">
      <h2 class="text-xl md:text-2xl font-semibold mb-4">Udvalgte indlæg</h2>
      <div id="featuredGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </section>

    <!-- Alle indlæg -->
    <section class="mt-8">
      <div class="flex items-end justify-between mb-3">
        <h2 class="text-xl md:text-2xl font-semibold">Alle indlæg</h2>
        <div id="count" class="text-sm text-neutral-500"></div>
      </div>
      <div id="list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
      <p id="empty" class="mt-6 text-sm text-neutral-600 hidden">Ingen indlæg matcher dine filtre.</p>
      <p id="fatal" class="mt-6 text-sm text-red-600 hidden">
        Kunne ikke hente indlæg. Tjek at <a class="underline" href="/blog/posts.json" target="_blank" rel="noopener">/blog/posts.json</a> findes og er gyldig JSON.
      </p>
    </section>
  </main>

  <!-- Footer -->
  <script src="/assets/include-footer.js?v=2" defer></script>

  <script>
    (function () {
      const FEATURED = [
        "seo-for-begyndere-2025",
        "intern-linkbuilding-strategi",
        "core-web-vitals-2025"
      ];

      let ALL = [];
      let TAGS = [];
      let query = "";
      let activeTag = "alle";

      const $q = document.getElementById("q");
      const $clear = document.getElementById("clearBtn");
      const $chips = document.getElementById("tagChips");
      const $list = document.getElementById("list");
      const $count = document.getElementById("count");
      const $empty = document.getElementById("empty");
      const $fatal = document.getElementById("fatal");
      const $diag = document.getElementById("diag");
      const $featuredWrap = document.getElementById("featuredWrap");
      const $featuredGrid = document.getElementById("featuredGrid");

      // --- Robust loader for posts.json (prøver flere stier) ---
      async function loadPosts() {
        const ts = Date.now();
        const candidates = [
          `/blog/posts.json?ts=${ts}`,
          `posts.json?ts=${ts}`,
          `/posts.json?ts=${ts}`
        ];
        let lastErr = null;
        for (const url of candidates) {
          try {
            const txt = await fetch(url, { cache: "no-store" }).then(r => r.text());
            if (txt.trim().startsWith("<")) throw new Error("Fik HTML i stedet for JSON fra " + url);
            const data = JSON.parse(txt.replace(/^\uFEFF/, "")); // fjern evt. BOM
            if (!Array.isArray(data)) throw new Error("JSON er ikke et array fra " + url);
            $diag.textContent = "Loaded: " + url;
            $diag.classList.remove("hidden");
            return data;
          } catch (e) {
            lastErr = e;
            console.warn("posts.json load failed at", url, e);
          }
        }
        throw lastErr || new Error("Kunne ikke hente posts.json");
      }

      function buildTags() {
        const freq = new Map();
        ALL.forEach(p => {
          (Array.isArray(p.tags) ? p.tags : []).forEach(t => {
            const key = String(t || "").trim().toLowerCase();
            if (!key) return;
            freq.set(key, (freq.get(key) || 0) + 1);
          });
        });
        TAGS = Array.from(freq.entries()).sort((a,b)=>b[1]-a[1]).map(([t])=>t);

        $chips.innerHTML = "";
        const addChip = (label, value) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "chip text-sm";
          btn.textContent = label;
          btn.dataset.value = value;
          if (value === activeTag) btn.classList.add("chip-active");
          btn.addEventListener("click", () => {
            activeTag = value;
            $chips.querySelectorAll("button").forEach(b => b.classList.remove("chip-active"));
            btn.classList.add("chip-active");
            render();
          });
          $chips.appendChild(btn);
        };
        addChip("Alle", "alle");
        TAGS.forEach(t => addChip(t, t));
      }

      function applyFilters(list) {
        let out = list;
        if (activeTag !== "alle") {
          out = out.filter(p => Array.isArray(p.tags) && p.tags.map(String).map(x=>x.toLowerCase()).includes(activeTag));
        }
        if (query) {
          const q = query.toLowerCase();
          out = out.filter(p =>
            (p.title || "").toLowerCase().includes(q) ||
            (p.excerpt || "").toLowerCase().includes(q) ||
            (Array.isArray(p.tags) && p.tags.some(t => String(t).toLowerCase().includes(q)))
          );
        }
        return out;
      }

      function renderFeatured() {
        const items = ALL.filter(p => FEATURED.includes(p.slug));
        if (!items.length) return;
        $featuredWrap.classList.remove("hidden");
        $featuredGrid.innerHTML = items.map(p => CardHTML(p, true)).join("");
      }

      function render() {
        const filtered = applyFilters(ALL);
        $count.textContent = filtered.length ? `${filtered.length} indlæg` : "";
        $empty.classList.toggle("hidden", filtered.length > 0);
        $list.innerHTML = filtered.map(p => CardHTML(p, false)).join("");
      }

      function CardHTML(p, featured=false) {
        const tags = (Array.isArray(p.tags) ? p.tags : []).slice(0, 4);
        return `
          <a href="/blog/${p.slug}.html" class="block rounded-2xl border bg-white p-5 hover:shadow transition">
            ${featured ? '<div class="text-[11px] uppercase tracking-wide text-blue-700 mb-2">Udvalgt</div>' : ''}
            <div class="font-semibold">${esc(p.title || "Uden titel")}</div>
            ${p.excerpt ? `<div class="text-sm text-neutral-600 mt-1">${esc(p.excerpt)}</div>` : ""}
            <div class="mt-3 flex items-center justify-between text-xs text-neutral-500">
              <span>${p.date ? esc(p.date) : ""}</span>
              <span class="flex gap-2">${tags.map(t => `<span class="px-2 py-1 rounded-full bg-neutral-100">${esc(String(t))}</span>`).join("")}</span>
            </div>
          </a>
        `;
      }

      function esc(s) { return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])); }

      // Søg UI
      $q.addEventListener("input", () => {
        query = $q.value.trim();
        $clear.classList.toggle("hidden", query.length === 0);
        render();
      });
      $clear.addEventListener("click", () => {
        $q.value = "";
        query = "";
        $clear.classList.add("hidden");
        render();
      });

      // Init
      loadPosts()
        .then(data => {
          ALL = data.slice().sort((a,b) => String(b.date||"").localeCompare(String(a.date||"")));
          buildTags();
          renderFeatured();
          render();
        })
        .catch(err => {
          console.error(err);
          $fatal.classList.remove("hidden");
        });
    })();
  </script>
</body>
</html>
