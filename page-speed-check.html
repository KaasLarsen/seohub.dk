<!doctype html>
<html lang="da">
  <head>
    <meta charset="utf-8" />
    <title>Page Speed Quick-Check (proxy) | Seohub.dk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Hurtig, praktisk hastigheds-check af en side: hentetid (via proxy), HTML-størrelse, billeder, scripts, stylesheets og basis-SEO.">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">

    <!-- Cookie consent + GA (som vi bruger overalt) -->
    <script src="/assets/consent-analytics.js" defer></script>

    <!-- Global header/footer -->
    <script src="/assets/include-header.js?v=7" defer></script>
    <script src="/assets/include-footer.js?v=2" defer></script>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Structured data -->
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"WebPage",
      "name":"Page Speed Quick-Check",
      "url":"https://www.seohub.dk/page-speed-quick-check.html",
      "description":"Hurtig, praktisk hastigheds-check af en side: hentetid (via proxy), HTML-størrelse, billeder, scripts, stylesheets og basis-SEO."
    }
    </script>
  </head>
  <body class="min-h-screen bg-gradient-to-b from-neutral-50 to-neutral-100 text-neutral-900">
    <!-- Hero -->
    <section class="py-10 md:py-14">
      <div class="max-w-6xl mx-auto px-4">
        <div class="rounded-2xl p-12 md:p-16 text-white shadow-lg"
             style="background:linear-gradient(135deg,#6366f1 0%,#3b82f6 50%,#06b6d4 100%)">
          <p class="text-xs uppercase tracking-wider text-blue-100/90 mb-2">Værktøj</p>
          <h1 class="text-4xl md:text-5xl font-extrabold mb-3 leading-tight">Page Speed Quick-Check</h1>
          <p class="text-blue-100 text-lg md:text-xl max-w-3xl">
            Få et lynhurtigt overblik: “proxy-hentetid”, HTML-størrelse, antal billeder/scripts/styles, title-længde og viewport.
          </p>
        </div>
      </div>
    </section>

    <!-- App -->
    <main class="max-w-6xl mx-auto px-4 pb-12 space-y-8">
      <!-- Input -->
      <section class="bg-white/70 backdrop-blur rounded-2xl shadow p-6 md:p-8 border border-neutral-100">
        <h2 class="text-xl md:text-2xl font-semibold mb-3">Test en URL</h2>
        <div class="md:flex items-end gap-3">
          <label class="block md:flex-1 mb-3 md:mb-0">
            <span class="block text-sm font-medium mb-1">URL</span>
            <input id="ps-url" type="url" placeholder="fx https://www.eksempel.dk/"
                   class="w-full rounded-2xl border px-4 py-3 focus:outline-none focus:ring focus:ring-indigo-200">
          </label>
          <button id="ps-run"
                  class="px-4 py-3 rounded-2xl text-white bg-blue-600 hover:bg-blue-700">
            Kør
          </button>
        </div>
        <p class="text-xs text-neutral-500 mt-2">
          Note: Vi bruger en gratis proxy (AllOrigins). Tider er vejledende. For dyb performance: brug PageSpeed Insights/WebPageTest nedenfor.
        </p>
      </section>

      <!-- Resultater -->
      <section id="ps-results" class="hidden bg-white/70 backdrop-blur rounded-2xl shadow p-6 md:p-8 border border-neutral-100">
        <h2 class="text-xl md:text-2xl font-semibold mb-4">Resultater</h2>

        <div class="grid md:grid-cols-2 gap-6">
          <!-- Målinger -->
          <div>
            <div class="grid sm:grid-cols-2 gap-4">
              <div class="rounded-2xl border p-4 bg-white">
                <div class="text-xs uppercase text-neutral-500">Proxy-hentetid (ca.)</div>
                <div id="ps-time" class="text-2xl font-bold mt-1">–</div>
              </div>
              <div class="rounded-2xl border p-4 bg-white">
                <div class="text-xs uppercase text-neutral-500">HTML-størrelse</div>
                <div id="ps-size" class="text-2xl font-bold mt-1">–</div>
              </div>
              <div class="rounded-2xl border p-4 bg-white">
                <div class="text-xs uppercase text-neutral-500">Billeder (img)</div>
                <div id="ps-imgs" class="text-2xl font-bold mt-1">–</div>
              </div>
              <div class="rounded-2xl border p-4 bg-white">
                <div class="text-xs uppercase text-neutral-500">Scripts</div>
                <div id="ps-scripts" class="text-2xl font-bold mt-1">–</div>
              </div>
              <div class="rounded-2xl border p-4 bg-white">
                <div class="text-xs uppercase text-neutral-500">Stylesheets (link rel=stylesheet)</div>
                <div id="ps-css" class="text-2xl font-bold mt-1">–</div>
              </div>
              <div class="rounded-2xl border p-4 bg-white">
                <div class="text-xs uppercase text-neutral-500">Title-længde</div>
                <div id="ps-titlelen" class="text-2xl font-bold mt-1">–</div>
              </div>
            </div>
          </div>

          <!-- Kvalitets-tjek -->
          <div class="space-y-3">
            <div class="rounded-2xl border p-4 bg-white">
              <div class="text-xs uppercase text-neutral-500 mb-1">Title</div>
              <div id="ps-title" class="text-sm break-words">–</div>
            </div>
            <div class="rounded-2xl border p-4 bg-white">
              <div class="text-xs uppercase text-neutral-500 mb-1">Viewport</div>
              <div id="ps-viewport" class="text-sm">–</div>
            </div>
            <div class="rounded-2xl border p-4 bg-white">
              <div class="text-xs uppercase text-neutral-500 mb-1">Meta description (uddrag)</div>
              <div id="ps-desc" class="text-sm break-words text-neutral-700">–</div>
            </div>
          </div>
        </div>

        <div class="mt-6 flex flex-wrap gap-3">
          <a id="ps-psi" target="_blank" rel="noopener"
             class="px-4 py-2 rounded-2xl text-white bg-blue-600 hover:bg-blue-700">Åbn i PageSpeed Insights</a>
          <a id="ps-wpt" target="_blank" rel="noopener"
             class="px-4 py-2 rounded-2xl border bg-white hover:bg-neutral-50">Åbn i WebPageTest</a>
        </div>

        <p id="ps-note" class="text-xs text-neutral-500 mt-3">
          * Proxy-hentetid inkluderer netværk → proxy → målsite → proxy → dig. Brug PSI/WPT for præcis måling af CWV.
        </p>
      </section>

      <!-- CTA (frivillig) -->
      <section class="bg-white/70 backdrop-blur rounded-2xl shadow p-6 md:p-8 border border-neutral-100">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-3">
          <div>
            <h3 class="text-lg font-semibold">Vil du forbedre din score?</h3>
            <p class="text-sm text-neutral-600">Tjek vores andre værktøjer – og få hosting/domæne på få minutter.</p>
          </div>
          <div class="flex flex-wrap gap-2">
            <a href="/serp-preview.html" class="px-4 py-2 rounded-2xl border bg-white hover:bg-neutral-50">SERP & Meta</a>
            <a href="/robots-generator.html" class="px-4 py-2 rounded-2xl border bg-white hover:bg-neutral-50">Robots.txt</a>
            <a href="/sitemap-generator.html" class="px-4 py-2 rounded-2xl border bg-white hover:bg-neutral-50">Sitemap.xml</a>
            <a href="/internal-link-builder.html" class="px-4 py-2 rounded-2xl border bg-white hover:bg-neutral-50">Intern links</a>
          </div>
        </div>
      </section>
    </main>

    <script>
      (function(){
        const $u = document.getElementById('ps-url');
        const $b = document.getElementById('ps-run');
        const $wrap = document.getElementById('ps-results');

        const $time = document.getElementById('ps-time');
        const $size = document.getElementById('ps-size');
        const $imgs = document.getElementById('ps-imgs');
        const $scripts = document.getElementById('ps-scripts');
        const $css = document.getElementById('ps-css');
        const $title = document.getElementById('ps-title');
        const $titlelen = document.getElementById('ps-titlelen');
        const $viewport = document.getElementById('ps-viewport');
        const $desc = document.getElementById('ps-desc');

        const $psi = document.getElementById('ps-psi');
        const $wpt = document.getElementById('ps-wpt');

        function normUrl(v){
          v = (v || "").trim();
          if (!v) return "";
          if (!/^https?:\/\//i.test(v)) v = "https://" + v;
          try { return new URL(v).href; } catch(e){ return ""; }
        }
        function prettyBytes(n){
          if (!Number.isFinite(n)) return "–";
          if (n < 1024) return n + " B";
          if (n < 1024*1024) return (n/1024).toFixed(1) + " kB";
          return (n/(1024*1024)).toFixed(2) + " MB";
        }

        async function run(){
          const url = normUrl($u.value);
          if (!url) { alert("Indsæt en gyldig URL"); return; }

          // Links til eksterne test
          $psi.href = "https://pagespeed.web.dev/analysis?url=" + encodeURIComponent(url);
          $wpt.href = "https://www.webpagetest.org/?url=" + encodeURIComponent(url);

          // Kald via AllOrigins raw endpoint (returnerer HTML som text, CORS-enabled)
          const proxy = "https://api.allorigins.win/raw?url=" + encodeURIComponent(url) + "&disableCache=true";

          $wrap.classList.remove('hidden');
          $time.textContent = "…";
          $size.textContent = "…";
          $imgs.textContent = "…";
          $scripts.textContent = "…";
          $css.textContent = "…";
          $title.textContent = "…";
          $titlelen.textContent = "…";
          $viewport.textContent = "…";
          $desc.textContent = "…";

          let t0 = performance.now();
          try {
            const res = await fetch(proxy, { cache: "no-cache" });
            const txt = await res.text();
            const t1 = performance.now();

            // Ca. hentetid via proxy
            $time.textContent = Math.max(0, Math.round(t1 - t0)) + " ms";

            // Størrelse (beregn via Blob for korrekte bytes)
            const bytes = new Blob([txt]).size;
            $size.textContent = prettyBytes(bytes);

            // Parse HTML
            const parser = new DOMParser();
            const doc = parser.parseFromString(txt, "text/html");

            // Title
            const title = (doc.querySelector("title")?.textContent || "").trim();
            $title.textContent = title || "—";
            $titlelen.textContent = title ? String(title.length) : "0";

            // Viewport
            const vp = doc.querySelector('meta[name="viewport"]')?.getAttribute('content') || "—";
            $viewport.textContent = vp;

            // Meta description (uddrag)
            const md = doc.querySelector('meta[name="description"]')?.getAttribute('content') || "—";
            $desc.textContent = md;

            // Counts
            $imgs.textContent = String(doc.querySelectorAll("img").length);
            $scripts.textContent = String(doc.querySelectorAll("script").length);
            $css.textContent = String(doc.querySelectorAll('link[rel="stylesheet"]').length);

          } catch (e){
            console.error(e);
            alert("Kunne ikke hente siden via proxy. Tjek at din CSP tillader https://api.allorigins.win og prøv igen.");
            $time.textContent = "fejl";
            $size.textContent = "fejl";
          }
        }

        document.getElementById('ps-run').addEventListener('click', run);
        document.getElementById('ps-url').addEventListener('keydown', (e) => {
          if (e.key === 'Enter') { e.preventDefault(); run(); }
        });
      })();
    </script>
  </body>
</html>
